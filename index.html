<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/style.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>Liebre y Conejo</title>
</head>
<body>
    <main>
        <div class="red-turn-text mobile">
            Reds turn
        </div>

        <div><h1>JUEGO DE LA LIEBRE Y EL CONEJO </h1></div>
        <div>
            <input type="button" value="iniciar juego" onclick="iniciarJuego()">
        </div>

        
        <div>
            <table>
            <tr>
                <td ><div id="dado1"></div> </td>
                <td><div id="dado2"></div></td>
            </tr>
            </table>
        </div>

        <div>
            <input type="button" value="Tirar dados" onclick="getToken()">
        </div>

        <div>

            <button id="send" title="Terminar turno!" style="width: 100%; height: 30px;" >Terminar turno!</button>
        
        </div>

        <div id="tabla">

            
        </div>
        <div id=tiro>

        </div>

        <div class="desktop">
            <div class="red-turn-text" id="u1" style="color: #1B4F72;">
                
            </div>
            <p id="divider">|</p>
            <div class="black-turn-text" id="u2"  style="color: #000000;">
               
            </div>
        </div>
        <div class="black-turn-text mobile">
            Blacks turn
        </div>
    </main>
    <script  src="/script.js"></script>
    <script>
        (function() {
            const sendBtn = document.querySelector('#send');
            const dado1 = document.getElementById('dado1').getElementsByTagName("*");
            const dado2 = document.getElementById('dado2').getElementsByTagName("*");
            let ws;

            function showMessage(message) {
                dado1[0].src=(message);
                
            }

      
          function init() {
            if (ws) {
              ws.onerror = ws.onopen = ws.onclose = null;
              ws.close();
            }
      
            ws = new WebSocket('ws://localhost:6969');
            ws.onopen = () => {
              console.log('Connection opened!');
            }
            ws.onmessage = ({ data }) =>{
                showMessage(data);
                
            } 
            ws.onclose = function() {
              ws = null;
            }
          }
      
          sendBtn.onclick = function() {
            if (!ws) {
              showMessage("No WebSocket connection :(");
              return ;
            }
            
            ws.send(dado1[0].src);
            showMessage(dado1[0].src);

          }
      
          init();
        })();
      </script>
      
</body>
</html> 


